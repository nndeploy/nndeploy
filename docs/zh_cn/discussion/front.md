
# TODO

## 操作指南

## 第二期
1. 界面
   + 感叹号检测：目前修改正确，不应该出现感叹号 (ok)
   + 节点方块长度，修改位好看的长度 (ok)
   + 移除节点收缩 (ok)
   + 有一个默认workflow（后端会返回给前端一个默认的业务json，前端把该业务json可视化）(ok)
   + 节点的二级目录
   + 配置参数从字符串改为下拉框(ok)
   + 两侧的侧边栏支持拖拉 (ok)
   + 当字符串长度过长时，支持自动换行
   + 当param为空时，前端界面不显示(ok)
2. 操作逻辑bug
   + 新增workflow页面，之前的workflow页面消失 (ok)
   + workflow保存逻辑（save->页面改名->侧边栏出现一个json）(ok)
   + resource (ok)
3. **节点可视化**
   + 图片/视频等节点可视化
   + 文字节点可视化（显示文本的节点支持（llm））
4. **图的配置参数**
5. 业务json的数据结构优化
   + 除非有node_repository_，否则不存储
6. **代码优化，提高稳定性和可读性**
7. 图不用组显示，图还是用节点显示，内部会递归的暂时node_repository_ (ok)

### 第三期
1. 界面
   + 切换workflow之后导致的连线消失问题（详细描述下该问题：现象，如何使用的api，我们做了那些修改，我们的初步猜测）（ok）
   + 运行时信息
      + 节点耗时（运行完成后，后端会返回结果给前端）
      + 每个节点运行的运行状态（空闲，运行中，已经运行，等待运行，保持一个固定的链接，后端会定时返回结果）
   + 后端机器信息展示（后端会提供一个完全的字符串给前端，前端展示即可）
   + 前端屏蔽节点的以下几个参数：node_type_、is_graph、is_inner，...(ok)
   + 增加bilibili点击跳转按钮
   + 不主动修改节点排布方式，不去做主动的auto layout（ok）
   + **保存json是否要保存原始的位置信息呢？**
   + 支持运行任务队列显示
2. 功能
   + workflow增加上传按钮
   + images/videos/models的下载功能
   + 连线验证
   + 选中部分节点导出为json
   + 增加注册、登录机制
   + 创建子目录，支持上传整个目录下的文件
3. 子图（有思路就去做，不做强制要求）
4. 代码优化
5. 出错处理

### 重排优先级

#### 1. 前端界面细节

+ 增加bilibili点击跳转按钮
+ nndeploy目前还是叫demo-free-layout，得把这个demo_free_layout改成nndeploy
+ infer节点输入输出端口重叠，加上Desc的描述后又正常
+ 鼠标放到左侧侧边栏的节点上时，出现该节点的desc描述
+ 节点的Desc不允许更改

+ 节点的宽度调整

+ 一个画布中节点重名问题
   + 前端增加节点，没有考虑重名的问题
      + 情况1 ：在一个已有的页面上，增加节点，是从0开始编号的
      + 情况2 : 在一个已有的页面上，增删节点后，新增节点可能会与之前重名
   + 拷贝节点，整个节点都拷贝，没有考虑名字重名问题
   + 最简单的解决办法：不管增加删除，始终维护一个最大的index，按照这个最大的index来给节点加后缀，从nndeploy json变成节点前，先找到这个图中最大  得数字


+ 连接线之间的 加+ 删掉
+ 连线验证
   + 输入端口只接受一条连线
   + 节点type字段一致，后续会有可以连线map，目前map是空的 

+ json优化，nndeploy的底层json中不保存id信息，支持以下两种情况
   + 从前端存储的json，保存节点的排布信息
   + 假如没有节点排布信息，是从nndeploy底层原生json中加载的信息，就采用当前的方式


#### 2. 前后端联调
+ 图的配置参数，在底部栏增加 Config 按钮
+ Node的二级目录，能否支持动态多级目录呢？
+ 选中部分节点导出为json，看是否可以通过原生的Group功能实现

+ workflow增加 上传、下载、删除 按钮
+ images/videos/models的 上传、下载、删除 功能
+ nodes 增加 上传、下载、删除 功能（**下载删除**暂时不做）

+ **节点可视化**
   + 图片/视频等节点可视化
   + 文字节点可视化（显示文本的节点支持（llm））

+ 运行时信息 === 增加进度条
   + 节点耗时（运行完成后，后端会返回结果给前端）
   + 每个节点运行的运行状态（空闲，运行中，已经运行，等待运行，保持一个固定的链接，后端会定时返回结果）

+ 后端机器信息展示（后端会提供一个完全的字符串给前端，前端展示即可） - 暂时不做
+ 支持运行任务队列显示 - 暂时不做
+ 增加注册、登录机制 - 暂时不做



#### 3. 子图（有思路就去做，不做强制要求）

#### 4. 代码优化

#### 5. 杂项
+ 前端编译打包
+ 运行文档 (安装环境、安装、运行、注意事项)

## 20250723

### 细节优化
+ 显示运行时间的单位信息，加ms信息
+ 前端自带的字母，都为大写字母开头（主要是为了与底部的Config、Save、Run）
+ 鼠标移到节点上，出现Desc信息
+ 移除结尾的 http://localhost:3001/design 中的 design
+ 检查discord == https://discord.gg/9rUwfAaMbr
+ 移除run success
+ Config的配置
+ 运行的时候，没有IDLE的信息展示
+ 保存json名字带json时，整个命名会略微混乱 -- 重点关注
+ 节点上的id还是会在前端显示，去一个特殊名字，然后屏蔽它

+ 视频节点一直在加载播放，除非点击，否则不播放，只要打开页面时，视频就会一直播放
+ Group
   + Group功能的Expand和Collapse功能不显示在前端，要不就要把该功能实现
   + 保存的json没有输入输出的信息（节点和图都没有）

### 功能
+ 支持对任意目录下的文件展示
+ Log的获取
   + run status有更丰富的状态，比如失败
   + 运行报错信息一定要返回，在graphrunner这个类的返回值，用户需要拿到，复用之前run sucess的弹窗
   + 需要获取正在初始化的状态
+ 保存Group的信息

### 代码优化

### 2025.07.24
+ 只要代码运行起来了，他会一直向后端请求数据，这个逻辑应该是结果节点，假如没有运行完成，不会向后端发起数据请求
+ 加一个INIT的标志
+ 大批量名字不会修改